<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Aponia ‚Äì Servicios</title>
    <meta
      name="description"
      content="Administraci√≥n de servicios y experiencias de Aponia."
    />

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Fuentes -->
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Playfair+Display:wght@600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Inter", sans-serif;
      }
      h1,
      .brand__name {
        font-family: "Playfair Display", serif;
      }
    </style>
  </head>

  <body class="bg-white text-slate-800">
    <!-- HEADER -->
    <div th:replace="fragments/navbar_admin :: navbar_admin"></div>

    <!-- MAIN -->
    <main class="max-w-6xl mx-auto px-6 py-6">
      <!-- Encabezado -->
      <div>
        <h1 class="text-3xl text-[#0a3d62]">Servicios</h1>
        <p class="text-slate-600 mt-1">
          Gestiona los servicios y experiencias disponibles.
        </p>

        <div class="flex flex-wrap items-center justify-between gap-4 mt-4">
          <a
            th:href="@{/servicios/nuevo}"
            class="inline-flex items-center gap-2 rounded-xl bg-[#cfa15a] px-4 py-2 font-semibold text-white shadow hover:shadow-lg active:translate-y-px"
          >
            <span class="text-lg leading-none">Ôºã</span> Nuevo servicio
          </a>
          <span class="text-sm text-slate-500"
            >Total: <span th:text="${#lists.size(servicios)}">0</span></span
          >
        </div>

        <!-- flashes -->
        <div
          th:if="${ok}"
          th:text="${ok}"
          class="mt-3 rounded-lg border border-emerald-200 bg-emerald-50 px-3 py-2 text-emerald-700"
        ></div>
        <div
          th:if="${error}"
          th:text="${error}"
          class="mt-3 rounded-lg border border-rose-200 bg-rose-50 px-3 py-2 text-rose-700"
        ></div>
      </div>

      <!-- Tabla (desktop) -->
      <div
        class="hidden lg:block mt-6 rounded-2xl border border-slate-200 shadow"
      >
        <div class="overflow-auto rounded-2xl">
          <table class="w-full min-w-[960px] border-collapse">
            <thead>
              <tr
                class="bg-slate-50 text-left text-[11px] uppercase text-slate-800"
              >
                <th class="p-3">Imagen</th>
                <th class="p-3">Nombre y lugar</th>
                <th class="p-3">Descripci√≥n</th>
                <th class="p-3">Duraci√≥n</th>
                <th class="p-3">Capacidad</th>
                <th class="p-3">Precio / persona</th>
                <th class="p-3">Acciones</th>
              </tr>
            </thead>
            <tbody class="text-sm">
              <tr
                th:each="s : ${servicios}"
                class="border-t border-slate-200 hover:bg-slate-50"
              >
                <td class="p-3">
                  <img
                    th:src="${#lists.isEmpty(s.imagenes)} ? @{/img/placeholder-servicio.jpg} : ${s.imagenes.get(0).url}"
                    alt="Imagen servicio"
                    class="w-16 h-16 object-cover rounded-xl border border-slate-200"
                  />
                </td>
                <td class="p-3">
                  <div class="font-semibold" th:text="${s.nombre}">Nombre</div>
                  <div class="text-xs text-slate-500" th:text="${s.lugar}">
                    Lugar
                  </div>
                </td>
                <td class="p-3 text-slate-600" th:text="${s.descripcion}">
                  Descripci√≥n
                </td>
                <td class="p-3">
                  <span
                    class="inline-block rounded-full bg-slate-100 px-3 py-1 text-xs"
                    th:text="|${s.duracionMinutos} min|"
                  >
                    0 min
                  </span>
                </td>
                <td
                  class="p-3"
                  th:text="${s.capacidadMaxima != null ? s.capacidadMaxima : '-'}"
                >
                  -
                </td>
                <td
                  class="p-3 font-semibold whitespace-nowrap"
                  th:text="|$ ${#numbers.formatDecimal(s.precioPorPersona,0,'POINT',2,'COMMA')} COP|"
                >
                  $ 0,00 COP
                </td>
                <td class="p-3">
                  <div class="flex gap-2">
                    <a
                      th:href="@{|/servicios/${s.id}/editar|}"
                      class="inline-flex items-center rounded-lg border border-[#0a3d62] px-3 py-1 text-sm font-semibold text-[#0a3d62] hover:bg-[#0a3d62]/5"
                      >Editar</a
                    >
                    <form
                      th:action="@{|/servicios/${s.id}/eliminar|}"
                      method="post"
                      onsubmit="return confirm('¬øEliminar este servicio?');"
                    >
                      <button
                        type="submit"
                        class="rounded-lg bg-rose-600 px-3 py-1 text-sm font-semibold text-white hover:bg-rose-700"
                      >
                        Eliminar
                      </button>
                    </form>
                  </div>
                </td>
              </tr>
              <tr th:if="${#lists.isEmpty(servicios)}">
                <td colspan="7" class="py-10 text-center text-slate-500">
                  No hay servicios creados a√∫n.
                  <a
                    th:href="@{/servicios/nuevo}"
                    class="font-semibold text-[#0a3d62]"
                    >Crear el primero</a
                  >.
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Cards (m√≥vil) -->
      <div
        class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6 mt-6 lg:hidden"
      >
        <article
          th:each="s : ${servicios}"
          class="rounded-2xl border border-slate-200 shadow hover:shadow-lg overflow-hidden"
        >
          <div class="relative h-44">
            <img
              th:src="${#lists.isEmpty(s.imagenes)} ? @{/img/placeholder-servicio.jpg} : ${s.imagenes.get(0).url}"
              alt="Imagen servicio"
              class="absolute inset-0 w-full h-full object-cover"
            />
            <span
              class="absolute top-3 right-3 rounded-lg bg-white/90 border border-slate-200 px-2 py-1 text-xs font-semibold"
              th:text="|$ ${#numbers.formatDecimal(s.precioPorPersona,0,'POINT',2,'COMMA')}|"
            ></span>
          </div>
          <div class="p-4">
            <h3 class="text-lg font-semibold" th:text="${s.nombre}">
              Nombre del servicio
            </h3>
            <p class="text-sm text-slate-500 mt-1" th:text="${s.lugar}">
              Lugar
            </p>
            <p
              class="text-sm text-slate-600 mt-2 line-clamp-2"
              th:text="${s.descripcion}"
            >
              Breve descripci√≥n‚Ä¶
            </p>
            <div class="flex flex-wrap gap-2 mt-3 text-xs text-slate-600">
              <span
                class="rounded-full bg-slate-100 px-3 py-1"
                th:text="|${s.duracionMinutos} min|"
                >0 min</span
              >
              <span class="rounded-full bg-slate-100 px-3 py-1"
                >üë•
                <span
                  th:text="${s.capacidadMaxima != null ? s.capacidadMaxima : '-'}"
                  >-</span
                ></span
              >
            </div>
            <div class="flex gap-2 mt-4">
              <a
                th:href="@{|/servicios/${s.id}/editar|}"
                class="inline-flex items-center rounded-lg border border-[#0a3d62] px-3 py-1 text-sm font-semibold text-[#0a3d62] hover:bg-[#0a3d62]/5"
                >Editar</a
              >
              <form
                th:action="@{|/servicios/${s.id}/eliminar|}"
                method="post"
                onsubmit="return confirm('¬øEliminar este servicio?');"
              >
                <button
                  type="submit"
                  class="rounded-lg bg-rose-600 px-3 py-1 text-sm font-semibold text-white hover:bg-rose-700"
                >
                  Eliminar
                </button>
              </form>
            </div>
          </div>
        </article>

        <div
          th:if="${#lists.isEmpty(servicios)}"
          class="border rounded-xl p-6 text-center text-slate-500"
        >
          No hay servicios creados a√∫n.
          <a th:href="@{/servicios/nuevo}" class="font-semibold text-[#0a3d62]"
            >Crear el primero</a
          >.
        </div>
      </div>
    </main>

    <footer
      class="border-t border-slate-200 text-center text-slate-500 text-sm py-4 mt-8"
    >
      ¬© <span id="year"></span> Aponia. Todos los derechos reservados.
    </footer>

    <script>
      document.getElementById("year").textContent = new Date().getFullYear();
    </script>
  </body>
</html>
